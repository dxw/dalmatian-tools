#!/bin/bash
"$APP_ROOT/bin/dalmatian-refresh-config" > /dev/null
usage() {
  echo "List environment names (e.g. 'staging' or 'prod') for an infrastructure"
  echo "Usage: $(basename "$0") <infrastructure name [OPTIONAL]>" 1>&2
  echo "  -h                     - help"
  exit 1
}
INFRASTRUCTURE_NAME="${1:-*}"
while getopts "h" opt; do
  case $opt in
    h)
      usage
      exit;;
    *)
      usage
      exit;;
  esac
done

yq r --printMode p "$APP_ROOT/bin/tmp/dalmatian-config/dalmatian.yml" "infrastructures.$INFRASTRUCTURE_NAME.environments.*" | awk -F. '{print $2": "$4}'
