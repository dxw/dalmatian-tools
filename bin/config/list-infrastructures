#!/bin/bash

# exit on failures
set -e
set -o pipefail

"$APP_ROOT/bin/dalmatian-refresh-config" > /dev/null

usage() {
  echo "Description: List all infrastructures"
  echo
  echo "Usage: dalmatian config $(basename "$0")" 1>&2
  echo "  -h                     Get help with this command"
  exit 1
}

while getopts "h" opt; do
  case $opt in
    h)
      usage
      exit;;
    *)
      usage
      exit;;
  esac
done

yq e '.infrastructures | keys()' "$APP_ROOT/bin/tmp/dalmatian-config/dalmatian.yml" | sed 's/- *//g'
